{
  "openapi": "3.1.0",
  "info": {
    "title": "ADK Progress Bridge",
    "description": "\nA real-time bridge for Google Agent Development Kit (ADK) tools. \nTransforms long-running backend tasks into streaming Server-Sent Events (SSE) \nto provide immediate feedback to the frontend.\n\n### Key Features:\n* **Tool Execution**: Start any registered tool with arbitrary arguments.\n* **Progress Streaming**: Receive granular progress updates, logs, and metadata via SSE.\n* **Observability**: Built-in Prometheus metrics and structured logging.\n* **Resilience**: Automatic cleanup of stale sessions and graceful shutdown.\n",
    "contact": {
      "name": "Teddy",
      "url": "https://github.com/google-marketing-solutions/adk-progress-bridge"
    },
    "license": {
      "name": "MIT"
    },
    "version": "1.6.0"
  },
  "paths": {
    "/health": {
      "get": {
        "tags": ["Observability"],
        "summary": "System Health Overview",
        "description": "Returns a comprehensive health report including CPU, memory, and WebSocket throughput.",
        "responses": { "200": { "description": "Successful Response" } }
      }
    },
    "/version": {
      "get": {
        "tags": ["Discovery"],
        "summary": "Get System Version",
        "description": "Returns the current version, git commit, and operational apex status.",
        "responses": { "200": { "description": "Successful Response" } }
      }
    },
    "/tools": {
      "get": {
        "tags": ["Discovery"],
        "summary": "List Available Tools",
        "description": "Returns a list of all registered tool names that can be executed.",
        "operationId": "list_tools_tools_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": { "type": "string" }
                }
              }
            }
          }
        }
      }
    },
    "/metrics": {
      "get": {
        "tags": [
          "Observability"
        ],
        "summary": "Get Prometheus Metrics",
        "description": "Exposes application metrics in Prometheus format for monitoring.",
        "operationId": "metrics_metrics_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/start_task/{tool_name}": {
      "post": {
        "tags": [
          "Execution"
        ],
        "summary": "Start a Tool Task",
        "description": "Initializes a registered tool with the provided arguments and returns a session call_id.",
        "operationId": "start_task_start_task__tool_name__post",
        "parameters": [
          {
            "name": "tool_name",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "description": "The name of the registered tool to execute.",
              "title": "Tool Name"
            },
            "description": "The name of the registered tool to execute."
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "additionalProperties": true,
                "description": "Key-value pairs of arguments to pass to the tool function.",
                "examples": [
                  {
                    "duration": 10
                  }
                ],
                "default": {},
                "title": "Args"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/StartTaskResponse"
                }
              }
            }
          },
          "404": {
            "description": "Tool not found in registry"
          },
          "400": {
            "description": "Invalid arguments provided for the tool"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/stream/{call_id}": {
      "get": {
        "tags": [
          "Execution"
        ],
        "summary": "Stream Task Progress",
        "description": "Connect to this endpoint via EventSource (SSE) to receive progress updates for a previously started task.\nThe stream yields events of type 'progress', 'result', or 'error'.",
        "operationId": "stream_task_stream__call_id__get",
        "parameters": [
          {
            "name": "call_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "description": "The unique session ID returned by the /start_task endpoint.",
              "title": "Call Id"
            },
            "description": "The unique session ID returned by the /start_task endpoint."
          }
        ],
        "responses": {
          "200": {
            "description": "SSE Stream of ProgressEvent objects.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProgressEvent"
                }
              }
            }
          },
          "404": {
            "description": "Task not found or already consumed."
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "HTTPValidationError": {
        "properties": {
          "detail": {
            "items": {
              "$ref": "#/components/schemas/ValidationError"
            },
            "type": "array",
            "title": "Detail"
          }
        },
        "type": "object",
        "title": "HTTPValidationError"
      },
      "ProgressEvent": {
        "properties": {
          "call_id": {
            "type": "string",
            "title": "Call Id",
            "description": "The unique identifier for this specific task execution session.",
            "examples": [
              "550e8400-e29b-41d4-a716-446655440000"
            ]
          },
          "type": {
            "type": "string",
            "enum": [
              "task_started",
              "input_request",
              "progress",
              "result",
              "error"
            ],
            "title": "Type",
            "description": "The nature of the event being streamed. 'progress' indicates an interim update, 'result' is the final output, and 'error' signifies a failure.",
            "examples": [
              "progress",
              "result",
              "error"
            ]
          },
          "payload": {
            "anyOf": [
              {
                "$ref": "#/components/schemas/ProgressPayload"
              },
              {
                "additionalProperties": true,
                "type": "object"
              }
            ],
            "title": "Payload",
            "description": "The actual data payload. Contains a ProgressPayload object for 'progress' types, or the final result/error details."
          }
        },
        "type": "object",
        "required": [
          "call_id",
          "type",
          "payload"
        ],
        "title": "ProgressEvent",
        "description": "The event envelope sent over the Server-Sent Events (SSE) stream."
      },
      "ProgressPayload": {
        "properties": {
          "step": {
            "type": "string",
            "title": "Step",
            "description": "A human-readable label for the current task phase.",
            "examples": [
              "Analyzing documents",
              "Uploading results",
              "Scanning ports"
            ]
          },
          "pct": {
            "type": "integer",
            "maximum": 100.0,
            "minimum": 0.0,
            "title": "Pct",
            "description": "The completion percentage of the overall task (0-100).",
            "examples": [
              45
            ]
          },
          "log": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Log",
            "description": "Detailed log message, breadcrumb, or status update for the current step.",
            "examples": [
              "Found 12 matching records in batch 3...",
              "Port 80 is open",
              "Processed document 5 of 10"
            ]
          },
          "metadata": {
            "additionalProperties": true,
            "type": "object",
            "title": "Metadata",
            "description": "Structured key-value pairs providing additional context for this update.",
            "examples": [
              {
                "batch_size": 100,
                "doc_id": "doc_123",
                "retry_count": 0
              }
            ]
          }
        },
        "type": "object",
        "required": [
          "step",
          "pct"
        ],
        "title": "ProgressPayload",
        "description": "Standard schema for progress updates yielded by tools."
      },
      "StartTaskResponse": {
        "properties": {
          "call_id": {
            "type": "string",
            "title": "Call Id",
            "description": "The unique identifier (UUID) for the started task session. Use this to connect to the /stream/{call_id} endpoint.",
            "examples": [
              "550e8400-e29b-41d4-a716-446655440000"
            ]
          }
        },
        "type": "object",
        "required": [
          "call_id"
        ],
        "title": "StartTaskResponse",
        "description": "Response returned after successfully starting a task."
      },
      "ValidationError": {
        "properties": {
          "loc": {
            "items": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "integer"
                }
              ]
            },
            "type": "array",
            "title": "Location"
          },
          "msg": {
            "type": "string",
            "title": "Message"
          },
          "type": {
            "type": "string",
            "title": "Error Type"
          }
        },
        "type": "object",
        "required": [
          "loc",
          "msg",
          "type"
        ],
        "title": "ValidationError"
      }
    }
  }
}